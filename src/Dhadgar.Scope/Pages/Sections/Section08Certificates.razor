<MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-6" Elevation="0">
    <MudText Typo="Typo.h4" Color="Color.Secondary" Class="font-bold mb-6 pb-2" Style="border-bottom: 1px solid rgba(192, 132, 252, 0.3);">
        8. Certificate Management
    </MudText>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Certificate Architecture Overview</MudText>
    <MudPaper Class="rounded-xl p-4 mb-6 font-mono text-xs overflow-x-auto" Style="background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);">
        <MudText Typo="Typo.body2" Class="font-mono text-xs" Style="color: rgba(255,255,255,0.7); white-space: pre;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CERTIFICATE MANAGEMENT                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   EXTERNAL (User-Facing):                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Let's Encrypt  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Cloudflare API â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  cert-manager   â”‚   â”‚
â”‚   â”‚  (ACME CA)      â”‚         â”‚  (DNS-01)       â”‚         â”‚  (Ingress only) â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   INTERNAL (Pod-to-Pod):                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         CILIUM SERVICE MESH                              â”‚   â”‚
â”‚   â”‚   â€¢ Automatic mTLS between all pods                                      â”‚   â”‚
â”‚   â”‚   â€¢ No manual cert management                                            â”‚   â”‚
â”‚   â”‚   â€¢ Covers: services, PostgreSQL, RabbitMQ, Redis                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   AGENT CERTIFICATES:                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    NODES SERVICE (Agent Cert Manager)                    â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚  Bootstrap: Token â†’ Register â†’ Issue cert â†’ Establish mTLS              â”‚   â”‚
â”‚   â”‚  Renewal: Automated at 45 days before expiry                             â”‚   â”‚
â”‚   â”‚  DNS: agent-{id}.nodes.meridianconsole.com                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</MudText>
    </MudPaper>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Certificate Types</MudText>
    <MudSimpleTable Dense="true" Hover="true" Class="mb-6 rounded-xl" Style="background: rgba(0,0,0,0.2);">
        <thead>
            <tr style="background: rgba(255,255,255,0.05);">
                <th style="color: white; padding: 12px;">Type</th>
                <th style="color: white; padding: 12px;">Scope</th>
                <th style="color: white; padding: 12px;">Manager</th>
                <th style="color: white; padding: 12px;">Renewal</th>
            </tr>
        </thead>
        <tbody>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Ingress (User-facing)</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">*.meridianconsole.com</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">cert-manager</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">45 days (automated)</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Internal Pod-to-Pod</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">All cluster services</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Cilium</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Automatic (mesh)</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Agent mTLS</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">agent-{id}.nodes.*</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Nodes Service</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">45 days (automated)</td></tr>
        </tbody>
    </MudSimpleTable>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Agent Bootstrap Flow</MudText>
    <MudPaper Class="rounded-xl p-4 mb-6 font-mono text-xs overflow-x-auto" Style="background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);">
        <MudText Typo="Typo.body2" Class="font-mono text-xs" Style="color: rgba(255,255,255,0.7); white-space: pre;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AGENT BOOTSTRAP SEQUENCE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  1. ADMIN GENERATES TOKEN                                                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     POST /nodes/tokens      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚  Admin  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Nodes     â”‚                     â”‚
â”‚     â”‚   UI    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   :5040     â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     { token: "xxx" }        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                     (15 min expiry)                                              â”‚
â”‚                                                                                  â”‚
â”‚  2. AGENT REGISTERS                                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     POST /nodes/register    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚  Agent  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Nodes     â”‚                     â”‚
â”‚     â”‚  (new)  â”‚     { token: "xxx" }        â”‚   :5040     â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                    â”‚                             â”‚
â”‚  3. NODES SERVICE PROVISIONS CERT                  â”‚                             â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                     â–¼                                                            â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚  â€¢ Create DNS entry: agent-{id}.nodes.meridianconsole.com              â”‚ â”‚
â”‚     â”‚  â€¢ Request cert from Let's Encrypt (via Cloudflare API DNS-01)         â”‚ â”‚
â”‚     â”‚  â€¢ Store cert metadata in nodes_db                                      â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                                                            â”‚
â”‚  4. PUSH CERT TO AGENT                                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     cert + private key      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚  Agent  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   Nodes     â”‚                     â”‚
â”‚     â”‚  (new)  â”‚     (over initial TLS)      â”‚   :5040     â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                                  â”‚
â”‚  5. ESTABLISH mTLS                                                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     mTLS connection         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚  Agent  â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚   Nodes     â”‚                     â”‚
â”‚     â”‚  (reg)  â”‚     (ongoing comms)         â”‚   :5040     â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</MudText>
    </MudPaper>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">DNS-01 Challenge Flow</MudText>
    <MudSimpleTable Dense="true" Hover="true" Class="mb-6 rounded-xl" Style="background: rgba(0,0,0,0.2);">
        <thead>
            <tr style="background: rgba(255,255,255,0.05);">
                <th style="color: white; padding: 12px;">Step</th>
                <th style="color: white; padding: 12px;">Action</th>
                <th style="color: white; padding: 12px;">Component</th>
            </tr>
        </thead>
        <tbody>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">1</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Request new certificate order</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">â†’ Let's Encrypt ACME</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">2</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Create TXT record via API</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">â†’ Cloudflare API</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">3</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Validate challenge</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">â†’ Let's Encrypt ACME</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">4</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Delete TXT record</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">â†’ Cloudflare API</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">5</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">Store/push certificate</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">â†’ K8s Secret / Agent</td></tr>
        </tbody>
    </MudSimpleTable>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Renewal Policy</MudText>
    <MudPaper Class="rounded-xl p-4 mb-6" Style="background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.4);">
        <MudText Typo="Typo.body1" Style="color: rgba(16, 185, 129, 1);"><strong>âœ… Automated Renewal</strong></MudText>
        <MudText Typo="Typo.body2" Class="mt-2" Style="color: rgba(255,255,255,0.7);">
            â€¢ <strong style="color: white;">Validity:</strong> 90 days (Let's Encrypt standard)<br/>
            â€¢ <strong style="color: white;">Renewal trigger:</strong> 45 days before expiry (50% lifetime)<br/>
            â€¢ <strong style="color: white;">Automation:</strong> Fully automated â€” no manual intervention<br/>
            â€¢ <strong style="color: white;">Alerting:</strong> Alert if renewal fails 30 days before expiry
        </MudText>
    </MudPaper>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Internal Services (Cilium)</MudText>
    <MudPaper Class="rounded-xl p-4" Style="background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.4);">
        <MudText Typo="Typo.body1" Style="color: rgba(59, 130, 246, 1);"><strong>ğŸ”’ Pod-to-Pod Encryption</strong></MudText>
        <MudText Typo="Typo.body2" Class="mt-2 mb-2" Style="color: rgba(255,255,255,0.7);">
            Cilium service mesh handles all internal mTLS automatically:
        </MudText>
        <MudText Typo="Typo.body2" Style="color: rgba(255,255,255,0.7);">
            â€¢ All 12 control plane services<br/>
            â€¢ PostgreSQL connections (Platform DB, User DB)<br/>
            â€¢ RabbitMQ connections<br/>
            â€¢ Redis connections<br/>
            â€¢ Prometheus/Loki scraping
        </MudText>
        <MudText Typo="Typo.body2" Class="mt-2 font-italic" Style="color: rgba(255,255,255,0.5); font-size: 0.85rem;">
            No manual certificate management required for internal services.
        </MudText>
    </MudPaper>
</MudPaper>
