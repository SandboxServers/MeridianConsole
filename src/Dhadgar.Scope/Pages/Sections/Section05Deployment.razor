<MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-6" Elevation="0">
    <MudText Typo="Typo.h4" Class="font-bold mb-4">Section 5: Deployment Topology</MudText>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">High-Level Architecture</MudText>
    <MudText Typo="Typo.body1" Class="mb-6" Style="color: rgba(255,255,255,0.7);">Single Kubernetes cluster hosting dev/staging/prod as separate namespaces. Agent nodes run outside Kubernetes on isolated VLANs.</MudText>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">External Services</MudText>
    <div class="space-y-1 mb-6">
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Azure (Key Vault, AD, ACR, DevOps)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Cloudflare (DNS, WAF, CDN)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- New Relic (Observability)</MudText>
    </div>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Kubernetes Cluster</MudText>

    <MudText Typo="Typo.subtitle1" Color="Color.Secondary" Class="mt-4 mb-2 font-semibold">Infrastructure Layer</MudText>
    <div class="space-y-1 mb-4">
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- cert-manager (TLS automation)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Secrets Store CSI Driver (Azure Key Vault integration)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- ArgoCD (GitOps, read-only drift detection)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Azure DevOps Build Agent (self-hosted pod)</MudText>
    </div>

    <MudText Typo="Typo.subtitle1" Color="Color.Secondary" Class="mb-2 font-semibold">Platform Data Layer</MudText>
    <div class="space-y-1 mb-4">
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- <strong>PostgreSQL (platform):</strong> Application metadata (users, servers, agents, billing)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- <strong>RabbitMQ:</strong> Message queue for async operations</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- <strong>Redis:</strong> Caching, session state</MudText>
    </div>

    <MudText Typo="Typo.subtitle1" Color="Color.Secondary" Class="mb-2 font-semibold">User Data Layer</MudText>
    <MudAlert Severity="Severity.Error" Class="rounded-xl mb-4" Dense="true">
        <strong>HARD RULE:</strong> User data (game server databases, configs, saves) stored in separate PostgreSQL instance per environment. Platform DB and User DB must never share an instance.
    </MudAlert>

    <MudSimpleTable Dense="true" Hover="true" Class="mb-6 rounded-xl" Style="background: rgba(0,0,0,0.2);">
        <thead>
            <tr style="background: rgba(255,255,255,0.05);">
                <th style="color: white; padding: 12px;">Environment</th>
                <th style="color: white; padding: 12px;">User DB Instance</th>
            </tr>
        </thead>
        <tbody>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Dev</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">PostgreSQL (user-dev)</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Staging</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">PostgreSQL (user-staging)</td></tr>
            <tr><td style="color: rgba(255,255,255,0.8); padding: 12px;">Prod</td><td style="color: rgba(255,255,255,0.8); padding: 12px;">PostgreSQL (user-prod)</td></tr>
        </tbody>
    </MudSimpleTable>

    <MudText Typo="Typo.h6" Color="Color.Primary" Class="mb-3">Agent Nodes</MudText>
    <div class="space-y-1 mb-6">
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Run <strong>outside Kubernetes</strong> on isolated VLANs</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Linux + Windows agents (cross-platform)</MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Connect to cluster via <strong>mTLS</strong></MudText>
        <MudText Typo="Typo.body1" Style="color: rgba(255,255,255,0.7);">- Managed by Nodes Service (cert issuance, health checks)</MudText>
    </div>

    <MudAlert Severity="Severity.Info" Class="rounded-xl" Dense="true">
        <strong>Future Note:</strong> When to split prod to dedicated cluster? When customer base grows to the point where resource contention or blast radius concerns justify the operational overhead (likely 500+ active servers).
    </MudAlert>
</MudPaper>