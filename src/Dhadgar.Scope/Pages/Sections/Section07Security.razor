<section id="security" class="bg-gray-800 rounded-xl p-6 border border-indigo-700">
    <h2 class="text-2xl font-bold text-purple-400 mb-6 border-b border-purple-600 pb-2">
        7. Security Architecture
    </h2>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Security Philosophy</h3>
    <div class="bg-gray-900 border border-gray-600 rounded-lg p-4 mb-6">
        <p class="text-white font-semibold mb-2">üîê TLS Everywhere, Always, Forever</p>
        <p class="text-gray-300 text-sm">Every connection, internal or external, is encrypted. No exceptions.</p>
    </div>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Transport Security</h3>
    <table class="w-full text-sm border-collapse mb-6">
        <thead>
            <tr class="bg-gray-700 text-white">
                <th class="border border-gray-600 p-2 text-left">Connection</th>
                <th class="border border-gray-600 p-2 text-left">Security</th>
                <th class="border border-gray-600 p-2 text-left">TLS Version</th>
            </tr>
        </thead>
        <tbody class="text-gray-300">
            <tr class="bg-gray-800"><td class="border border-gray-600 p-2">User ‚Üí Cloudflare</td><td class="border border-gray-600 p-2">TLS</td><td class="border border-gray-600 p-2">1.3 (preferred), 1.2 (minimum)</td></tr>
            <tr><td class="border border-gray-600 p-2">Cloudflare ‚Üí Cluster</td><td class="border border-gray-600 p-2">TLS (Full/Strict mode)</td><td class="border border-gray-600 p-2">1.2 minimum</td></tr>
            <tr class="bg-gray-800"><td class="border border-gray-600 p-2">Agent ‚Üî Cluster</td><td class="border border-gray-600 p-2">mTLS (mutual authentication)</td><td class="border border-gray-600 p-2">1.2 minimum</td></tr>
            <tr><td class="border border-gray-600 p-2">Microservices ‚Üî Microservices</td><td class="border border-gray-600 p-2">Cilium mTLS (service mesh)</td><td class="border border-gray-600 p-2">1.2 minimum</td></tr>
        </tbody>
    </table>

    <div class="bg-gray-900 border border-gray-600 rounded-lg p-4 mb-6">
        <p class="text-white font-semibold mb-2">üîê TLS Version Policy</p>
        <ul class="text-gray-300 text-sm space-y-1">
            <li>‚Ä¢ <strong class="text-white">Minimum:</strong> TLS 1.2 for all connections</li>
            <li>‚Ä¢ <strong class="text-white">Preferred:</strong> TLS 1.3 where supported</li>
            <li>‚Ä¢ <strong class="text-white">Prohibited:</strong> TLS 1.0, TLS 1.1, SSL 3.0</li>
            <li>‚Ä¢ <strong class="text-white">Cipher Suites:</strong> Modern AEAD ciphers only (AES-GCM, ChaCha20-Poly1305)</li>
        </ul>
    </div>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Authentication Layers</h3>
    <table class="w-full text-sm border-collapse mb-6">
        <thead>
            <tr class="bg-gray-700 text-white">
                <th class="border border-gray-600 p-2 text-left">Actor</th>
                <th class="border border-gray-600 p-2 text-left">Method</th>
                <th class="border border-gray-600 p-2 text-left">Token Type</th>
            </tr>
        </thead>
        <tbody class="text-gray-300">
            <tr class="bg-gray-800"><td class="border border-gray-600 p-2">End Users</td><td class="border border-gray-600 p-2">OAuth (Discord/Steam)</td><td class="border border-gray-600 p-2">JWT Bearer</td></tr>
            <tr><td class="border border-gray-600 p-2">Node Agents (Bootstrap)</td><td class="border border-gray-600 p-2">One-time registration token</td><td class="border border-gray-600 p-2">15-minute expiry</td></tr>
            <tr class="bg-gray-800"><td class="border border-gray-600 p-2">Node Agents (Registered)</td><td class="border border-gray-600 p-2">mTLS client certificate</td><td class="border border-gray-600 p-2">X.509</td></tr>
            <tr><td class="border border-gray-600 p-2">External Webhooks</td><td class="border border-gray-600 p-2">Signature verification</td><td class="border border-gray-600 p-2">HMAC/RSA</td></tr>
        </tbody>
    </table>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Kubernetes Security</h3>
    <ul class="text-gray-300 space-y-2 mb-6">
        <li>‚Ä¢ <strong class="text-white">CNI:</strong> Cilium (network policy enforcement, mTLS between pods)</li>
        <li>‚Ä¢ <strong class="text-white">RBAC:</strong> Least-privilege service accounts per microservice</li>
        <li>‚Ä¢ <strong class="text-white">Secrets:</strong> Azure Key Vault + CSI driver (no secrets in etcd)</li>
        <li>‚Ä¢ <strong class="text-white">Pod Security:</strong> Restricted PSS baseline</li>
        <li>‚Ä¢ <strong class="text-white">Network Policies:</strong> Default deny, explicit allow per service</li>
    </ul>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Secret Management</h3>
    <ul class="text-gray-300 space-y-2 mb-6">
        <li>‚Ä¢ All secrets stored in Azure Key Vault</li>
        <li>‚Ä¢ CSI Secret Store driver mounts secrets as volumes</li>
        <li>‚Ä¢ Automatic rotation via Secrets Service (:5110)</li>
        <li>‚Ä¢ Secret access logged and auditable</li>
    </ul>

    <h3 class="text-xl font-semibold text-indigo-400 mb-3">Network Boundaries</h3>
    <ul class="text-gray-300 space-y-2">
        <li>‚Ä¢ <strong class="text-white">Edge:</strong> Cloudflare (WAF, DDoS protection)</li>
        <li>‚Ä¢ <strong class="text-white">Perimeter:</strong> UniFi Hardware Firewall (stateful inspection)</li>
        <li>‚Ä¢ <strong class="text-white">Internal:</strong> Cilium (pod-to-pod encryption, L3/L4 policies)</li>
        <li>‚Ä¢ <strong class="text-white">Data:</strong> Encrypted at rest (PostgreSQL, Redis), encrypted in transit</li>
    </ul>
</section>