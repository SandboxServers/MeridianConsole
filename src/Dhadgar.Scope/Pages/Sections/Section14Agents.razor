<MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-6 md:p-8" Elevation="0">
    <MudText Typo="Typo.h4" Color="Color.Secondary" Class="font-bold">15. Agent Architecture</MudText>

    <!-- Prominent Callout: Customer-Hosted -->
    <MudPaper Class="rounded-2xl border-2 p-6 mt-6 mb-6" Style="border-color: rgba(59, 130, 246, 0.5); background: rgba(30, 58, 138, 0.3);" Elevation="0">
        <MudText Typo="Typo.h5" Class="font-bold mb-3" Style="color: rgba(147, 197, 253, 1);">ğŸ  Customer-Hosted Agents</MudText>
        <MudText Typo="Typo.body1" Class="mb-4" Style="color: rgba(209, 213, 219, 1);">
            These agents run on <strong style="color: white;">your hardware</strong>, not ours. You install them on your own servers, and they coordinate with our control plane to provision and manage your game servers.
        </MudText>
        <MudGrid>
            <MudItem xs="12" md="4">
                <MudPaper Class="rounded-xl p-3" Style="background: rgba(17, 24, 39, 1);" Elevation="0">
                    <MudText Typo="Typo.body2" Class="font-semibold mb-1" Style="color: rgba(96, 165, 250, 1);">ğŸ“¥ Bootstrap</MudText>
                    <MudText Typo="Typo.body2" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">Install agent â†’ Register with control plane â†’ Receive certificate</MudText>
                </MudPaper>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudPaper Class="rounded-xl p-3" Style="background: rgba(17, 24, 39, 1);" Elevation="0">
                    <MudText Typo="Typo.body2" Class="font-semibold mb-1" Style="color: rgba(74, 222, 128, 1);">ğŸ® Provision</MudText>
                    <MudText Typo="Typo.body2" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">Control plane sends deployment commands â†’ Agent provisions game servers locally</MudText>
                </MudPaper>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudPaper Class="rounded-xl p-3" Style="background: rgba(17, 24, 39, 1);" Elevation="0">
                    <MudText Typo="Typo.body2" Class="font-semibold mb-1" Style="color: rgba(192, 132, 252, 1);">ğŸ“Š Telemetry</MudText>
                    <MudText Typo="Typo.body2" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">Agent ships metrics, logs, console output â†’ Displayed in Web UI</MudText>
                </MudPaper>
            </MudItem>
        </MudGrid>
    </MudPaper>

    <!-- Agent Platform Descriptions -->
    <MudGrid Class="mb-6">
        <MudItem xs="12" md="6">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(22, 163, 74, 0.6);" Elevation="0">
                <MudText Typo="Typo.h6" Class="font-semibold mb-3" Style="color: rgba(74, 222, 128, 1);">ğŸ§ Agent.Linux</MudText>
                <MudText Typo="Typo.body2" Class="mb-4" Style="color: rgba(156, 163, 175, 1);">Runs as a systemd service on your Linux server. Manages game servers via Docker containers.</MudText>
                <ul style="color: rgba(156, 163, 175, 1); font-size: 0.875rem; list-style: none; padding-left: 0; margin: 0;">
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Deployment:</strong> Systemd service</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Isolation:</strong> One Docker container per game server</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Resources:</strong> cgroup limits (CPU, RAM, disk I/O)</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Storage:</strong> Volume mounts for persistent game data</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Encryption:</strong> LUKS full disk encryption (optional)</li>
                </ul>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" md="6">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(37, 99, 235, 0.6);" Elevation="0">
                <MudText Typo="Typo.h6" Class="font-semibold mb-3" Style="color: rgba(96, 165, 250, 1);">ğŸªŸ Agent.Windows</MudText>
                <MudText Typo="Typo.body2" Class="mb-4" Style="color: rgba(156, 163, 175, 1);">Runs as a Windows Service on your Windows server. Manages game servers as child processes.</MudText>
                <ul style="color: rgba(156, 163, 175, 1); font-size: 0.875rem; list-style: none; padding-left: 0; margin: 0;">
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Deployment:</strong> Windows Service</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Isolation:</strong> Job Objects for resource limits</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Resources:</strong> CPU affinity, memory limits, priority</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Required for:</strong> ARK, Conan Exiles, some Unity games</li>
                    <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Encryption:</strong> BitLocker full disk encryption (optional)</li>
                </ul>
            </MudPaper>
        </MudItem>
    </MudGrid>

    <!-- Trust & Transparency -->
    <MudText Typo="Typo.h5" Color="Color.Info" Class="mt-8 mb-4 pb-2 font-bold" Style="border-bottom: 1px solid rgba(75, 85, 99, 0.6);">ğŸ”’ Trust & Transparency</MudText>
    <MudPaper Class="rounded-2xl border-2 p-6 mb-6" Style="border-color: rgba(202, 138, 4, 0.6); background: rgba(113, 63, 18, 0.3);" Elevation="0">
        <MudText Typo="Typo.h6" Class="font-bold mb-3" Style="color: rgba(253, 224, 71, 1);">âš ï¸ Important: Your Hardware, Your Rules</MudText>
        <MudText Typo="Typo.body2" Style="color: rgba(209, 213, 219, 1);">
            We <strong style="color: white;">cannot and will not</strong> enforce encryption or security policies on your hardware.
            That's <strong style="color: white;">your responsibility</strong>. What we <em>can</em> do is prove that our agents have limited,
            well-defined operations and cannot execute arbitrary code against your machines.
        </MudText>
    </MudPaper>

    <MudGrid Class="mb-6">
        <!-- Trust Mechanism 1: Command Audit Logging -->
        <MudItem xs="12" md="6" lg="4">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(21, 128, 61, 0.7);" Elevation="0">
                <div class="d-flex align-center gap-3 mb-3">
                    <span style="font-size: 2rem;">ğŸ“</span>
                    <MudText Typo="Typo.body1" Class="font-bold" Style="color: rgba(74, 222, 128, 1);">Command Audit Logging</MudText>
                </div>
                <MudText Typo="Typo.body2" Class="mb-3" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    Every command the control plane sends to the agent is logged <strong style="color: white;">locally on your machine</strong>.
                </MudText>
                <MudPaper Class="rounded-xl p-3 mb-3" Style="background: rgba(31, 41, 55, 1);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="mb-2" Style="color: rgba(107, 114, 128, 1);">Log locations:</MudText>
                    <div class="mb-3">
                        <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(156, 163, 175, 1);">ğŸ§ <strong style="color: white;">Linux:</strong></MudText>
                        <code style="color: rgba(74, 222, 128, 1); font-size: 0.75rem;">/var/log/meridian-agent/commands.log</code>
                    </div>
                    <div>
                        <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(156, 163, 175, 1);">ğŸªŸ <strong style="color: white;">Windows Event Log:</strong></MudText>
                        <code style="color: rgba(96, 165, 250, 1); font-size: 0.75rem; display: block; margin-bottom: 4px;">Applications and Services Logs â†’ Meridian Console â†’ Agent Commands</code>
                        <MudText Typo="Typo.caption" Style="color: rgba(107, 114, 128, 1); font-style: italic;">Custom event source: <code style="color: rgba(147, 197, 253, 1);">MeridianAgent</code></MudText>
                    </div>
                </MudPaper>
                <MudText Typo="Typo.caption" Style="color: rgba(156, 163, 175, 1);">
                    <strong style="color: white;">You can audit these logs</strong> anytime to see exactly what our control plane requested your agent to do.
                </MudText>
            </MudPaper>
        </MudItem>

        <!-- Trust Mechanism 2: No Arbitrary Code Execution -->
        <MudItem xs="12" md="6" lg="4">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(185, 28, 28, 0.7);" Elevation="0">
                <div class="d-flex align-center gap-3 mb-3">
                    <span style="font-size: 2rem;">ğŸš«</span>
                    <MudText Typo="Typo.body1" Class="font-bold" Style="color: rgba(248, 113, 113, 1);">No Arbitrary Code Execution</MudText>
                </div>
                <MudText Typo="Typo.body2" Class="mb-3" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    The agent <strong style="color: white;">only executes predefined operations</strong> from a whitelist. We cannot send arbitrary shell commands.
                </MudText>
                <MudPaper Class="rounded-xl p-3 mb-3" Style="background: rgba(31, 41, 55, 1);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(107, 114, 128, 1);">Allowed operations:</MudText>
                    <ul style="color: rgba(156, 163, 175, 1); font-size: 0.75rem; list-style: none; padding-left: 0; margin: 0;">
                        <li style="margin-bottom: 4px;">â€¢ <code style="color: rgba(147, 197, 253, 1);">install_game_server</code></li>
                        <li style="margin-bottom: 4px;">â€¢ <code style="color: rgba(147, 197, 253, 1);">start_server</code> / <code style="color: rgba(147, 197, 253, 1);">stop_server</code></li>
                        <li style="margin-bottom: 4px;">â€¢ <code style="color: rgba(147, 197, 253, 1);">collect_metrics</code></li>
                        <li style="margin-bottom: 4px;">â€¢ <code style="color: rgba(147, 197, 253, 1);">stream_console_output</code></li>
                        <li style="margin-bottom: 4px;">â€¢ <code style="color: rgba(147, 197, 253, 1);">upload_file</code> / <code style="color: rgba(147, 197, 253, 1);">download_file</code></li>
                    </ul>
                </MudPaper>
                <MudText Typo="Typo.caption" Style="color: rgba(156, 163, 175, 1);">
                    Anything outside this whitelist is <strong style="color: white;">rejected</strong> by the agent.
                </MudText>
            </MudPaper>
        </MudItem>

        <!-- Trust Mechanism 3: Declarative Operations Manifest -->
        <MudItem xs="12" md="6" lg="4">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(126, 34, 206, 0.7);" Elevation="0">
                <div class="d-flex align-center gap-3 mb-3">
                    <span style="font-size: 2rem;">ğŸ“‹</span>
                    <MudText Typo="Typo.body1" Class="font-bold" Style="color: rgba(192, 132, 252, 1);">Declarative Operations Manifest</MudText>
                </div>
                <MudText Typo="Typo.body2" Class="mb-3" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    The agent ships with a <strong style="color: white;">manifest file</strong> listing every operation it can perform and what privileges each requires.
                </MudText>
                <MudPaper Class="rounded-xl p-3 mb-3" Style="background: rgba(31, 41, 55, 1);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(107, 114, 128, 1);">Example manifest entry:</MudText>
                    <pre style="color: rgba(216, 180, 254, 1); font-size: 0.75rem; margin: 0; white-space: pre;">install_game_server:
  privileges: [file_write, process_spawn]
  scope: /opt/gameservers/*
  description: "Downloads and installs game server binaries"</pre>
                </MudPaper>
                <MudText Typo="Typo.caption" Style="color: rgba(156, 163, 175, 1);">
                    <strong style="color: white;">You can review this manifest</strong> before installing the agent to understand exactly what it's capable of.
                </MudText>
            </MudPaper>
        </MudItem>

        <!-- Trust Mechanism 4: Permission Scoping -->
        <MudItem xs="12" md="6" lg="4">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(29, 78, 216, 0.7);" Elevation="0">
                <div class="d-flex align-center gap-3 mb-3">
                    <span style="font-size: 2rem;">ğŸ”</span>
                    <MudText Typo="Typo.body1" Class="font-bold" Style="color: rgba(96, 165, 250, 1);">Principle of Least Privilege</MudText>
                </div>
                <MudText Typo="Typo.body2" Class="mb-3" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    The agent runs with <strong style="color: white;">minimum required permissions</strong> and can only access specific directories.
                </MudText>
                <MudPaper Class="rounded-xl p-3 mb-3" Style="background: rgba(31, 41, 55, 1);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(107, 114, 128, 1);">Linux example:</MudText>
                    <ul style="color: rgba(156, 163, 175, 1); font-size: 0.75rem; list-style: none; padding-left: 0; margin: 0;">
                        <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">User:</strong> <code style="color: rgba(103, 232, 249, 1);">meridian-agent</code> (dedicated user)</li>
                        <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Write access:</strong> <code style="color: rgba(103, 232, 249, 1);">/opt/gameservers/</code> only</li>
                        <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">No root:</strong> Agent does not run as root</li>
                    </ul>
                    <MudText Typo="Typo.caption" Class="mt-2 mb-1" Style="color: rgba(107, 114, 128, 1);">Windows example:</MudText>
                    <ul style="color: rgba(156, 163, 175, 1); font-size: 0.75rem; list-style: none; padding-left: 0; margin: 0;">
                        <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">Service Account:</strong> Restricted permissions</li>
                        <li style="margin-bottom: 4px;">â€¢ <strong style="color: white;">ACLs:</strong> Explicit folder/process permissions</li>
                    </ul>
                </MudPaper>
                <MudText Typo="Typo.caption" Style="color: rgba(156, 163, 175, 1);">
                    <strong style="color: white;">You control the user</strong> the agent runs as and can further restrict permissions via your OS.
                </MudText>
            </MudPaper>
        </MudItem>

        <!-- Trust Mechanism 5: Signed Binaries -->
        <MudItem xs="12" md="6" lg="4">
            <MudPaper Class="rounded-2xl p-5 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(194, 65, 12, 0.7);" Elevation="0">
                <div class="d-flex align-center gap-3 mb-3">
                    <span style="font-size: 2rem;">ğŸ”</span>
                    <MudText Typo="Typo.body1" Class="font-bold" Style="color: rgba(251, 146, 60, 1);">Signed Binaries</MudText>
                </div>
                <MudText Typo="Typo.body2" Class="mb-3" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    All agent releases are <strong style="color: white;">cryptographically signed</strong> via Azure Trusted Signing so you can verify authenticity.
                </MudText>
                <MudPaper Class="rounded-xl p-3 mb-3" Style="background: rgba(31, 41, 55, 1);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="mb-1" Style="color: rgba(107, 114, 128, 1);">Benefits:</MudText>
                    <ul style="color: rgba(156, 163, 175, 1); font-size: 0.75rem; list-style: none; padding-left: 0; margin: 0;">
                        <li style="margin-bottom: 4px;">â€¢ âœ… No "Unknown Publisher" warnings on Windows</li>
                        <li style="margin-bottom: 4px;">â€¢ âœ… Verify it's really from Meridian Console</li>
                        <li style="margin-bottom: 4px;">â€¢ âœ… Detect tampering before installation</li>
                        <li style="margin-bottom: 4px;">â€¢ âœ… Integrated with Azure DevOps pipeline</li>
                    </ul>
                </MudPaper>
                <MudPaper Class="rounded-xl p-2" Style="background: rgba(6, 78, 59, 0.3); border: 1px solid rgba(21, 128, 61, 0.7);" Elevation="0">
                    <MudText Typo="Typo.caption" Style="color: rgba(134, 239, 172, 1);">
                        <strong>Implementation:</strong> Azure Trusted Signing (Basic tier, $10/month, 5,000 ops/month)
                    </MudText>
                </MudPaper>
            </MudPaper>
        </MudItem>
    </MudGrid>

    <!-- Future Enhancements -->
    <MudText Typo="Typo.h5" Color="Color.Info" Class="mt-8 mb-4 pb-2 font-bold" Style="border-bottom: 1px solid rgba(75, 85, 99, 0.6);">ğŸ”® Future Trust Enhancements</MudText>
    <MudGrid Class="mb-6">
        <MudItem xs="12" md="6">
            <MudPaper Class="rounded-2xl p-4 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(75, 85, 99, 1);" Elevation="0">
                <MudText Typo="Typo.body2" Class="font-semibold mb-2" Style="color: rgba(74, 222, 128, 1);">ğŸ“‚ Open Source Agents</MudText>
                <MudText Typo="Typo.caption" Class="mb-2" Style="color: rgba(156, 163, 175, 1);">Publish agent source code on GitHub for full auditability ("Don't trust, verify").</MudText>
                <MudText Typo="Typo.caption" Style="color: rgba(107, 114, 128, 1); font-style: italic;">Planned post-SaaS launch</MudText>
            </MudPaper>
        </MudItem>
        <MudItem xs="12" md="6">
            <MudPaper Class="rounded-2xl p-4 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(75, 85, 99, 1);" Elevation="0">
                <MudText Typo="Typo.body2" Class="font-semibold mb-2" Style="color: rgba(192, 132, 252, 1);">ğŸ›¡ï¸ Third-Party Audit</MudText>
                <MudText Typo="Typo.caption" Class="mb-2" Style="color: rgba(156, 163, 175, 1);">Pay security firm to audit and certify agent code (or rely on nerds to audit for free ğŸ˜„).</MudText>
                <MudText Typo="Typo.caption" Style="color: rgba(107, 114, 128, 1); font-style: italic;">When budget allows ($10k-50k)</MudText>
            </MudPaper>
        </MudItem>
    </MudGrid>

    <!-- Agent Security & Certificates -->
    <MudText Typo="Typo.h5" Color="Color.Info" Class="mt-8 mb-4 pb-2 font-bold" Style="border-bottom: 1px solid rgba(75, 85, 99, 0.6);">ğŸ” Agent Security & Certificates</MudText>
    <MudPaper Class="rounded-2xl p-5 border mb-6" Style="background: rgba(17, 24, 39, 1); border-color: rgba(75, 85, 99, 1);" Elevation="0">
        <MudGrid>
            <MudItem xs="12" md="6">
                <MudText Typo="Typo.body1" Class="font-medium mb-3" Style="color: rgba(192, 132, 252, 1);">ğŸ“ Registration Flow</MudText>
                <ol style="color: rgba(156, 163, 175, 1); font-size: 0.875rem; padding-left: 20px; margin: 0;">
                    <li style="margin-bottom: 8px;">Admin generates one-time registration code (15-minute expiry) via Web UI</li>
                    <li style="margin-bottom: 8px;">Customer runs agent installer with code on their hardware</li>
                    <li style="margin-bottom: 8px;">Agent registers with Nodes Service using code</li>
                    <li style="margin-bottom: 8px;">Nodes Service creates DNS entry: <code style="color: rgba(103, 232, 249, 1);">agent-{id}.nodes.meridianconsole.com</code></li>
                    <li style="margin-bottom: 8px;">Nodes Service requests certificate from Let's Encrypt (DNS-01 via Cloudflare)</li>
                    <li style="margin-bottom: 8px;">Certificate pushed to agent over secure bootstrap channel</li>
                    <li style="margin-bottom: 8px;">Agent installs certificate and establishes <strong style="color: rgba(103, 232, 249, 1);">mTLS connection</strong></li>
                </ol>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudText Typo="Typo.body1" Class="font-medium mb-3" Style="color: rgba(192, 132, 252, 1);">ğŸ”„ Certificate Lifecycle</MudText>
                <MudSimpleTable Dense="true" Style="color: rgba(156, 163, 175, 1); font-size: 0.875rem;">
                    <tbody>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">CA:</strong></td><td style="padding: 4px 0;">Let's Encrypt</td></tr>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">DNS:</strong></td><td style="padding: 4px 0; font-family: monospace; font-size: 0.75rem;">agent-{id}.nodes.meridianconsole.com</td></tr>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">Validity:</strong></td><td style="padding: 4px 0;">90 days</td></tr>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">Renewal:</strong></td><td style="padding: 4px 0;">45 days before expiry (automatic)</td></tr>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">Handler:</strong></td><td style="padding: 4px 0;">Nodes Service (not agent)</td></tr>
                        <tr><td style="padding: 4px 0;"><strong style="color: white;">Distribution:</strong></td><td style="padding: 4px 0;">Push over existing mTLS connection</td></tr>
                    </tbody>
                </MudSimpleTable>
                <MudPaper Class="mt-4 rounded-xl p-3" Style="background: rgba(6, 78, 59, 0.3); border: 1px solid rgba(21, 128, 61, 0.7);" Elevation="0">
                    <MudText Typo="Typo.caption" Class="font-semibold mb-1" Style="color: rgba(134, 239, 172, 1);">âœ… Zero Touch Renewal</MudText>
                    <MudText Typo="Typo.caption" Style="color: rgba(156, 163, 175, 1);">Agents never directly request certs. Nodes Service handles all ACME interactions and pushes renewed certs automatically.</MudText>
                </MudPaper>
            </MudItem>
        </MudGrid>
    </MudPaper>

    <!-- Agent Communication -->
    <MudText Typo="Typo.h5" Color="Color.Info" Class="mt-8 mb-4 pb-2 font-bold" Style="border-bottom: 1px solid rgba(75, 85, 99, 0.6);">ğŸ“¡ Agent Communication</MudText>
    <MudPaper Class="rounded-2xl p-4 border mb-6" Style="background: rgba(17, 24, 39, 1); border-color: rgba(75, 85, 99, 1);" Elevation="0">
        <MudText Typo="Typo.body1" Class="font-medium mb-3" Style="color: rgba(103, 232, 249, 1);">Agent Boot Sequence</MudText>
        <pre style="color: rgba(74, 222, 128, 1); font-size: 0.75rem; white-space: pre; margin: 0;">1. Agent loads mTLS certificate from local storage
   â””â”€ Linux: /etc/meridianconsole/certs/
   â””â”€ Windows: C:\ProgramData\MeridianConsole\certs\

2. Establish WSS connection to Nodes Service
   â””â”€ wss://nodes.meridianconsole.com/ws
   â””â”€ mTLS mutual authentication

3. Send HELLO message with metadata
   â””â”€ OS version, CPU cores, RAM, disk space
   â””â”€ Agent version, capabilities

4. Receive ACK + assigned server list
   â””â”€ Control plane tells agent what servers should be running

5. Reconcile local state
   â””â”€ Start servers that should be running
   â””â”€ Stop servers that shouldn't be running
   â””â”€ Report any discrepancies

6. Enter command loop
   â””â”€ Heartbeat every 30 seconds
   â””â”€ Listen for control plane commands
   â””â”€ Stream console output, metrics, logs</pre>
    </MudPaper>

    <MudPaper Class="rounded-2xl p-4 border" Style="background: rgba(17, 24, 39, 1); border-color: rgba(75, 85, 99, 1);" Elevation="0">
        <MudText Typo="Typo.body1" Class="font-medium mb-3" Style="color: rgba(103, 232, 249, 1);">Certificate Renewal (Automatic)</MudText>
        <pre style="color: rgba(250, 204, 21, 1); font-size: 0.75rem; white-space: pre; margin: 0;">1. Nodes Service detects certificate expiring in &lt; 45 days
   â””â”€ Scheduled job runs daily checking all agent certs

2. Nodes Service requests new certificate from Let's Encrypt
   â””â”€ DNS-01 challenge via Cloudflare API
   â””â”€ Creates TXT record: _acme-challenge.agent-{id}.nodes.meridianconsole.com

3. Let's Encrypt validates and issues new certificate

4. Nodes Service pushes new certificate to agent
   â””â”€ Sent over existing mTLS connection
   â””â”€ Agent receives cert + private key

5. Agent installs new certificate
   â””â”€ Writes to local storage (replaces old cert)
   â””â”€ Reloads TLS context (no restart required)

6. Agent confirms installation
   â””â”€ Sends confirmation message to Nodes Service
   â””â”€ Nodes Service marks renewal as complete</pre>
    </MudPaper>

    <!-- Key Points Summary -->
    <MudPaper Class="mt-8 rounded-2xl border-2 p-6" Style="border-color: rgba(37, 99, 235, 0.6); background: rgba(30, 58, 138, 0.3);" Elevation="0">
        <MudText Typo="Typo.h6" Class="font-bold mb-4" Style="color: rgba(147, 197, 253, 1);">ğŸ¯ Key Takeaways</MudText>
        <MudGrid>
            <MudItem xs="12" md="6">
                <MudText Typo="Typo.body2" Class="font-semibold mb-2" Style="color: white;">âœ… What We Do</MudText>
                <ul style="color: rgba(209, 213, 219, 1); font-size: 0.875rem; list-style: none; padding-left: 0; margin: 0;">
                    <li style="margin-bottom: 4px;">â€¢ Prove limited scope of operations</li>
                    <li style="margin-bottom: 4px;">â€¢ Provide audit logs on your machine</li>
                    <li style="margin-bottom: 4px;">â€¢ Run with least privilege</li>
                    <li style="margin-bottom: 4px;">â€¢ Whitelist allowed operations</li>
                    <li style="margin-bottom: 4px;">â€¢ Publish operations manifest</li>
                    <li style="margin-bottom: 4px;">â€¢ Sign all binaries cryptographically</li>
                </ul>
            </MudItem>
            <MudItem xs="12" md="6">
                <MudText Typo="Typo.body2" Class="font-semibold mb-2" Style="color: white;">âŒ What We Don't Do</MudText>
                <ul style="color: rgba(209, 213, 219, 1); font-size: 0.875rem; list-style: none; padding-left: 0; margin: 0;">
                    <li style="margin-bottom: 4px;">â€¢ Enforce encryption (your choice)</li>
                    <li style="margin-bottom: 4px;">â€¢ Execute arbitrary code</li>
                    <li style="margin-bottom: 4px;">â€¢ Access files outside designated paths</li>
                    <li style="margin-bottom: 4px;">â€¢ Run with elevated privileges by default</li>
                    <li style="margin-bottom: 4px;">â€¢ Hide what the agent is doing</li>
                </ul>
            </MudItem>
        </MudGrid>
    </MudPaper>
</MudPaper>
