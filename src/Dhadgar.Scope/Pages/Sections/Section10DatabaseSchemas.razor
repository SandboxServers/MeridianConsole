<MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-6" Elevation="0">
    <MudText Typo="Typo.h4" Color="Color.Secondary" Class="font-bold mb-6 pb-2" Style="border-bottom: 1px solid rgba(192, 132, 252, 0.3);">
        10. Database Schemas
    </MudText>

    <MudGrid>
        <MudItem xs="12" lg="8">
            <MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-5 mb-4" Elevation="0">
                <div class="d-flex flex-column flex-md-row align-md-center justify-space-between gap-3">
                    <div>
                        <MudText Typo="Typo.h6" Color="Color.Info" Class="mb-2">Schema explorer</MudText>
                        <MudText Typo="Typo.body2" Style="color: rgba(255,255,255,0.7);">
                            We model <strong style="color: white;">schema-first</strong> everywhere (e.g. <code class="rounded px-1" style="background: rgba(0,0,0,0.3);">identity.users</code>).
                            That gives us a clean "switch" between:
                            <strong style="color: white;">SaaS (DB-per-service)</strong> and
                            <strong style="color: white;">KiP (schemas in one DB)</strong>.
                        </MudText>
                    </div>
                    <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/database-schemas" Class="rounded-xl">
                        Open explorer
                    </MudButton>
                </div>
            </MudPaper>

            <MudPaper Class="rounded-2xl border border-white/10 bg-black/20 p-4 mb-4" Elevation="0">
                <DbSchemaTreeView />
            </MudPaper>

            <MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-5" Elevation="0">
                <MudText Typo="Typo.h6" Style="color: white;" Class="mb-3">PostgreSQL-native upgrades we're leaning on</MudText>
                <MudText Typo="Typo.body2" Style="color: rgba(255,255,255,0.75);">
                    • <strong style="color: white;">UUID primary keys</strong> via <code class="rounded px-1" style="background: rgba(0,0,0,0.3);">pgcrypto</code> (<code class="rounded px-1" style="background: rgba(0,0,0,0.3);">gen_random_uuid()</code>).<br/>
                    • <strong style="color: white;">Case-insensitive identifiers</strong> for email/keys using <code class="rounded px-1" style="background: rgba(0,0,0,0.3);">citext</code>.<br/>
                    • <strong style="color: white;">JSONB + GIN indexes</strong> for flexible per-game configuration and metadata.<br/>
                    • <strong style="color: white;">Partial indexes</strong> for hot queries (e.g., active rows only).<br/>
                    • <strong style="color: white;">SKIP LOCKED</strong> queue-claim patterns for workers.<br/>
                    • <strong style="color: white;">Optional RLS</strong> for tenant isolation (defense-in-depth), without forcing it day one.
                </MudText>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" lg="4">
            <MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-5 mb-4" Elevation="0">
                <MudText Typo="Typo.h6" Style="color: white;" Class="mb-3">SaaS vs KiP (database reality)</MudText>

                <MudPaper Class="rounded-xl border border-white/10 bg-black/20 p-3 mb-3" Elevation="0">
                    <MudText Typo="Typo.body1" Style="color: white;"><strong>SaaS</strong></MudText>
                    <MudText Typo="Typo.body2" Class="mt-2" Style="color: rgba(255,255,255,0.75); font-size: 0.875rem;">
                        • <strong>DB-per-service</strong>, but still schema-first inside each DB.<br/>
                        • All platform DBs live on the <strong>Platform Postgres HA cluster</strong>.<br/>
                        • Customer game-server DBs live on the <strong>User DB HA cluster</strong> — <strong>or BYO DB server</strong> if the customer wants.<br/>
                        • Meridian can provision/manage user DBs with only network/IAM access + endpoint info.
                    </MudText>
                </MudPaper>

                <MudPaper Class="rounded-xl border border-white/10 bg-black/20 p-3" Elevation="0">
                    <MudText Typo="Typo.body1" Style="color: white;"><strong>KiP</strong></MudText>
                    <MudText Typo="Typo.body2" Class="mt-2" Style="color: rgba(255,255,255,0.75); font-size: 0.875rem;">
                        • <strong>One physical DB</strong>, many schemas (<code class="rounded px-1" style="background: rgba(0,0,0,0.3);">identity.*</code>, <code class="rounded px-1" style="background: rgba(0,0,0,0.3);">servers.*</code>, …).<br/>
                        • Everything is <strong>BYO DB server</strong>, but KiP still runs DB creation + migrations.<br/>
                        • BYO DB can be the same instance hosting KiP itself.<br/>
                        • Game servers control what happens inside their DB. We provide <strong>ping, power, air</strong> (and optional backups).
                    </MudText>
                </MudPaper>
            </MudPaper>

            <MudPaper Class="rounded-2xl border border-white/10 bg-white/5 p-5" Elevation="0">
                <MudText Typo="Typo.h6" Style="color: white;" Class="mb-3">EF Core mapping</MudText>
                <MudText Typo="Typo.body2" Style="color: rgba(255,255,255,0.75); font-size: 0.875rem;">
                    • Each service uses its own <strong>DbContext</strong> and <strong>migrations</strong>.<br/>
                    • Each service sets a <strong>default schema</strong> (e.g. <code class="rounded px-1" style="background: rgba(0,0,0,0.3);">identity</code>).<br/>
                    • Cross-service IDs are stored as UUIDs with <strong>soft references</strong> (no cross-DB foreign keys in SaaS).
                </MudText>
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudPaper>
